(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,a){e.exports=a(38)},28:function(e,t,a){},29:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(19),r=a.n(o),l=a(2),c=a(3),i=a(5),u=a(4),d=a(6),h=(a(28),a(29),a(10)),m={register:function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return new Promise(function(e,t){fetch("/api/register",a).then(function(a){a.ok?(console.log("Registered successfully"),e()):t()}).catch(function(e){console.log(e)})})},login:function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return new Promise(function(e,t){fetch("/api/login",a).then(function(a){a.ok?(console.log("Logged in successfully"),console.log(a),e()):t()}).catch(function(e){console.log(e)})})},logout:function(){var e={method:"POST",headers:{"Content-Type":"application/json"}};return new Promise(function(t,a){fetch("/api/logout",e).then(function(e){e.ok?(console.log("Logged out successfully"),t()):a()}).catch(function(e){console.log(e)})})},getUsername:function(){var e={method:"GET",headers:{"Content-Type":"application/json"}};return new Promise(function(t,a){fetch("/api/username",e).then(function(e){if(e.ok)return e.json();a()}).then(function(e){t(e.username)}).catch(function(e){console.log(e)})})}},g=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.logoutHandler=function(){m.logout().then(function(e){a.setState({authText:"Not authorized"}),a.props.authChangeHandler()}).catch(function(e){console.log(e)})},a.state.authText=e.isAuthorized?"":"Not authorized",a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"updateUserText",value:function(){var e=this;m.getUsername().then(function(t){var a="Authorized as: "+t;e.setState({authText:a})}).catch(function(e){console.log(e)})}},{key:"componentDidMount",value:function(){this.props.isAuthorized&&this.updateUserText()}},{key:"componentDidUpdate",value:function(e){this.props.isAuthorized&&!e.isAuthorized&&this.updateUserText()}},{key:"render",value:function(){var e;return e=this.props.isAuthorized?s.a.createElement("button",{onClick:this.logoutHandler,className:"btn btn-outline-danger my-2 my-sm-0",id:"delete-all-button"},"Log Out"):s.a.createElement(h.b,{to:"/auth/"},s.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",id:"delete-all-button"},"Log In")),s.a.createElement("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark"},s.a.createElement("a",{className:"navbar-brand",href:"#"},"Tasks App"),s.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"},s.a.createElement("span",{className:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarCollapse"},s.a.createElement("ul",{className:"navbar-nav mr-auto"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(h.b,{className:"nav-link",to:"/tasks/"},"Tasks"))),s.a.createElement("ul",{className:"navbar-nav"},s.a.createElement("li",{className:"nav-item"},s.a.createElement("span",{className:"nav-link"},this.state.authText))),e))}}]),t}(n.Component),f=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.buttonClickHandler=function(){a.props.addTaskHandler(a.state.text),a.setState({text:""})},a.inputChangeHandler=function(e){a.setState({text:e.target.value})},a.state.text="",a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-8 col-md-6 col-lg-4"},s.a.createElement("input",{onChange:this.inputChangeHandler,value:this.state.text,className:"form-control mr-sm-2",type:"text",placeholder:"\u0417\u0430\u0434\u0430\u0447\u0430"})),s.a.createElement("div",{className:"col col-4 col-md-6 col-lg-4"},s.a.createElement("button",{onClick:this.buttonClickHandler,className:"btn btn-outline-success"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}}]),t}(n.Component),p=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.textClickHandler=function(){console.log("text click"),a.setState({editing:!0})},a.saveClickHandler=function(){console.log("save"),a.setState({editing:!1}),a.props.editTaskHandler(a.props.info._id,a.state.text)},a.inputChangeHandler=function(e){a.setState({text:e.target.value})},a.state.text=e.info.description,a.state.editing=!1,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,a=this;return e=this.state.editing?s.a.createElement("p",{className:"card-text"},s.a.createElement("input",{onChange:this.inputChangeHandler,value:this.state.text,className:"form-control mr-sm-2",type:"text"})):s.a.createElement("p",{className:"card-text",onClick:this.textClickHandler},this.state.text),this.state.editing&&(t=s.a.createElement("a",{href:"#",onClick:this.saveClickHandler,className:"btn btn-outline-success task-save-button"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")),s.a.createElement("div",{className:"col col-12 col-md-6 col-lg-4"},s.a.createElement("div",{className:"card",style:{width:"18rem"}},s.a.createElement("div",{className:"card-body"},e,s.a.createElement("a",{href:"#",onClick:function(e){a.props.deleteTaskHandler(a.props.info._id)},className:"btn btn-danger"},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),t)))}}]),t}(n.Component),v=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row",id:"task-list"},this.props.tasks.map(function(t){return s.a.createElement(p,{key:t._id,info:t,deleteTaskHandler:e.props.deleteTaskHandler,editTaskHandler:e.props.editTaskHandler})})))}}]),t}(n.Component),b={delete:function(e){var t="/api/tasks/"+e,a={method:"DELETE",headers:{"Content-Type":"application/json"}};return new Promise(function(e,n){fetch(t,a).then(function(t){t.ok?(console.log("Task deleted successfully"),e()):(console.log("Couldn't delete task"),n())}).catch(function(e){console.log(e)})})},deleteAll:function(){var e={method:"DELETE",headers:{"Content-Type":"application/json"}};return new Promise(function(t,a){fetch("/api/tasks",e).then(function(e){e.ok?(console.log("Tasks deleted successfully"),t()):(console.log("Couldn't delete tasks"),a())}).catch(function(e){console.log(e)})})},edit:function(e,t){var a="/api/tasks/"+e,n={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:t})};return new Promise(function(e,t){fetch(a,n).then(function(a){a.ok?(console.log("Task updated successfully"),e()):(console.log("Couldn't update task"),t())}).catch(function(e){console.log(e)})})},getAll:function(){var e={method:"GET",credentials:"include",headers:{"cache-control":"no-cache"}};return new Promise(function(t,a){fetch("/api/tasks",e).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){console.log("Couldn't load tasks"),console.log(e),a()})})},add:function(e){var t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:e})};return new Promise(function(e,a){fetch("/api/tasks",t).then(function(e){return e.json()}).then(function(t){console.log("Task added successfully"),console.log(t),e()}).catch(function(e){console.log(e),a()})})}},E=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.deleteAllTasksHandler=function(){b.deleteAll().then(function(){a.reloadTasks()})},a.deleteTaskHandler=function(e){b.delete(e).then(function(){a.reloadTasks()})},a.addTaskHandler=function(e){b.add(e).then(function(){a.reloadTasks()})},a.editTaskHandler=function(e,t){b.edit(e,t).then(function(){a.reloadTasks()})},a.reloadTasks=function(){b.getAll().then(function(e){a.setState({tasks:e})})},a.state.tasks=[],a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.isAuthorized&&this.reloadTasks()}},{key:"render",value:function(){return this.props.isAuthorized?s.a.createElement("div",null,s.a.createElement(f,{addTaskHandler:this.addTaskHandler}),s.a.createElement(v,{tasks:this.state.tasks,deleteTaskHandler:this.deleteTaskHandler,editTaskHandler:this.editTaskHandler})):s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-12"},s.a.createElement("h3",null,"You need to ",s.a.createElement(h.b,{to:"/auth/"},"authorize")," to access this page."))))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.authButtonClickHandler=function(){m.login(a.state.authLogin,a.state.authPassword).then(function(e){a.setState({loginSuccessMessage:"Authorization successful.",loginErrorMessage:"",authLogin:"",authPassword:""}),a.props.authChangeHandler()}).catch(function(e){a.setState({loginSuccessMessage:"",loginErrorMessage:"Authorization error. Make sure you entered correct credentials.",authLogin:"",authPassword:""})})},a.regButtonClickHandler=function(){m.register(a.state.regLogin,a.state.regPassword).then(function(e){a.setState({regSuccessMessage:"Registration successful.",regErrorMessage:"",regLogin:"",regPassword:""})}).catch(function(e){a.setState({regSuccessMessage:"",regErrorMessage:"Registration failed. Perhaps username is taken already.",regLogin:"",regPassword:""})})},a.authLoginChangeHandler=function(e){a.setState({authLogin:e.target.value})},a.authPasswordChangeHandler=function(e){a.setState({authPassword:e.target.value})},a.regLoginChangeHandler=function(e){a.setState({regLogin:e.target.value})},a.regPasswordChangeHandler=function(e){a.setState({regPassword:e.target.value})},a.state.authLogin="",a.state.authPassword="",a.state.regLogin="",a.state.regPassword="",a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,a,n;return this.state.loginSuccessMessage&&(e=s.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.loginSuccessMessage)),this.state.loginErrorMessage&&(t=s.a.createElement("div",{className:"alert alert-danger",role:"alert"},this.state.loginErrorMessage)),this.state.regSuccessMessage&&(a=s.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.regSuccessMessage)),this.state.regErrorMessage&&(n=s.a.createElement("div",{className:"alert alert-danger",role:"alert"},this.state.regErrorMessage)),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-6"},s.a.createElement("div",{className:"jumbotron"},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-12"},s.a.createElement("h2",null,"Authorization"),s.a.createElement("br",null),e,t,s.a.createElement("input",{onChange:this.authLoginChangeHandler,value:this.state.authLogin,className:"form-control mr-sm-2",type:"text",placeholder:"Username"}),s.a.createElement("br",null),s.a.createElement("input",{onChange:this.authPasswordChangeHandler,value:this.state.authPassword,className:"form-control mr-sm-2",type:"password",placeholder:"Password"}),s.a.createElement("br",null),s.a.createElement("button",{onClick:this.authButtonClickHandler,className:"btn btn-outline-success"},"Log In")))))),s.a.createElement("div",{className:"col col-6"},s.a.createElement("div",{className:"jumbotron"},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-12"},s.a.createElement("h2",null,"Registration"),s.a.createElement("br",null),a,n,s.a.createElement("input",{onChange:this.regLoginChangeHandler,value:this.state.regLogin,className:"form-control mr-sm-2",type:"text",placeholder:"Username"}),s.a.createElement("br",null),s.a.createElement("input",{onChange:this.regPasswordChangeHandler,value:this.state.regPassword,className:"form-control mr-sm-2",type:"password",placeholder:"Password"}),s.a.createElement("br",null),s.a.createElement("button",{onClick:this.regButtonClickHandler,className:"btn btn-outline-success"},"Register"))))))))}}]),t}(n.Component),C=a(22),N=a.n(C),T=a(11),y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},a.authChangeHandler=function(){var e=a.getIsAuthorized();a.setState({isAuthorized:e})},a.state.isAuthorized=a.getIsAuthorized(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getIsAuthorized",value:function(){return!!N.a.get("sid")}},{key:"render",value:function(){var e=this;return s.a.createElement(h.a,null,s.a.createElement("div",null,s.a.createElement(g,{isAuthorized:this.state.isAuthorized,authChangeHandler:this.authChangeHandler}),s.a.createElement(T.a,{exact:!0,path:"/",render:function(t){return s.a.createElement(E,Object.assign({},t,{isAuthorized:e.state.isAuthorized}))}}),s.a.createElement(T.a,{path:"/tasks/",render:function(t){return s.a.createElement(E,Object.assign({},t,{isAuthorized:e.state.isAuthorized}))}}),s.a.createElement(T.a,{path:"/auth/",render:function(t){return s.a.createElement(k,Object.assign({},t,{isAuthorized:e.state.isAuthorized,authChangeHandler:e.authChangeHandler}))}})))}}]),t}(n.Component);r.a.render(s.a.createElement(y,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.d2c1e62d.chunk.js.map